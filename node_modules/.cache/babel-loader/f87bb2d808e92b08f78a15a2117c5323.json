{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Projects\\\\kribble\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Projects\\\\kribble\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Projects\\\\kribble\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useCallback,useEffect,useRef,useState}from'react';import io from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var socket=io.connect('http://localhost:4000',{transports:['websocket','polling','flashsocket']});var colors=[\"red\",\"green\",\"yellow\",\"black\",\"blue\",\"orange\",\"tomato\",\"lightgreen\",\"skyblue\",\"brown\",\"pink\",\"white\"];function Can(){var canvasRef=useRef(null);var ctx=useRef(null);var _useState=useState(colors[0]),_useState2=_slicedToArray(_useState,2),selectedColor=_useState2[0],setSelectedColor=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),mouseDown=_useState4[0],setMouseDown=_useState4[1];var _useState5=useState({x:0,y:0}),_useState6=_slicedToArray(_useState5,2),lastPosition=_useState6[0],setPosition=_useState6[1];useEffect(function(){if(canvasRef.current){ctx.current=canvasRef.current.getContext('2d');}},[]);var draw=useCallback(function(x,y){if(mouseDown){ctx.current.beginPath();ctx.current.strokeStyle=selectedColor;ctx.current.lineWidth=10;ctx.current.lineJoin='round';ctx.current.moveTo(lastPosition.x,lastPosition.y);ctx.current.lineTo(x,y);ctx.current.closePath();ctx.current.stroke();console.log(x,y);socket.emit('drawing',{color:selectedColor,x1:lastPosition.x,y1:lastPosition.y,x:x,y:y});socket.on('drawing',function(drew){ctx.current.beginPath();ctx.current.strokeStyle=drew.color;ctx.current.lineWidth=10;ctx.current.lineJoin='round';ctx.current.moveTo(drew.x1,drew.y1);ctx.current.lineTo(drew.x,drew.y);ctx.current.closePath();ctx.current.stroke();console.log(drew);});setPosition({x:x,y:y});}},[lastPosition,mouseDown,selectedColor,setPosition]);var download=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var image,blob,blobURL,link;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:image=canvasRef.current.toDataURL('image/png');_context.next=3;return fetch(image);case 3:_context.next=5;return _context.sent.blob();case 5:blob=_context.sent;blobURL=URL.createObjectURL(blob);link=document.createElement('a');link.href=blobURL;link.download=\"image.png\";link.click();case 11:case\"end\":return _context.stop();}}},_callee);}));return function download(){return _ref.apply(this,arguments);};}();var clear=function clear(){ctx.current.clearRect(0,0,ctx.current.canvas.width,ctx.current.canvas.height);};var onMouseDown=function onMouseDown(e){setPosition({x:e.pageX-305,y:e.pageY-225});setMouseDown(true);};var onMouseUp=function onMouseUp(e){setMouseDown(false);};var onMouseMove=function onMouseMove(e){draw(e.pageX-305,e.pageY-225);};console.log(lastPosition,setPosition);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Addo\",children:[/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsx(\"canvas\",{style:{border:\"8px solid #000\",display:'inline-block',background:'white'},width:900,height:650,ref:canvasRef,onMouseDown:onMouseDown,onMouseUp:onMouseUp,onMouseLeave:onMouseUp,onMouseMove:onMouseMove})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"center\",{children:[/*#__PURE__*/_jsx(\"select\",{style:{fontSize:'2rem',fontFamily:'cursive'},value:selectedColor,onChange:function onChange(e){return setSelectedColor(e.target.value);},children:colors.map(function(color){return/*#__PURE__*/_jsx(\"option\",{value:color,children:color},color);})}),/*#__PURE__*/_jsx(\"button\",{style:{fontSize:'2rem',fontFamily:'cursive'},onClick:clear,children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{style:{fontSize:'2rem',fontFamily:'cursive'},onClick:download,children:\"Download\"})]})]})});}export default Can;","map":{"version":3,"sources":["C:/Projects/kribble/src/Can.js"],"names":["React","useCallback","useEffect","useRef","useState","io","socket","connect","transports","colors","Can","canvasRef","ctx","selectedColor","setSelectedColor","mouseDown","setMouseDown","x","y","lastPosition","setPosition","current","getContext","draw","beginPath","strokeStyle","lineWidth","lineJoin","moveTo","lineTo","closePath","stroke","console","log","emit","color","x1","y1","on","drew","download","image","toDataURL","fetch","blob","blobURL","URL","createObjectURL","link","document","createElement","href","click","clear","clearRect","canvas","width","height","onMouseDown","e","pageX","pageY","onMouseUp","onMouseMove","border","display","background","fontSize","fontFamily","target","value","map"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport io from 'socket.io-client'\n\nconst socket = io.connect('http://localhost:4000', { transports: ['websocket', 'polling', 'flashsocket'] })\n\nconst colors = [\n  \"red\",\n  \"green\",\n  \"yellow\",\n  \"black\",\n  \"blue\",\n  \"orange\",\n  \"tomato\",\n  \"lightgreen\",\n  \"skyblue\",\n  \"brown\",\n  \"pink\",\n  \"white\"\n]\n\nfunction Can() {\n  const canvasRef = useRef(null);\n  const ctx = useRef(null);\n\n  const [selectedColor, setSelectedColor] = useState(colors[0]);\n  const [mouseDown, setMouseDown] = useState(false);\n  const [lastPosition, setPosition] = useState({\n    x: 0,\n    y: 0\n  });\n\n  useEffect(() => {\n    if (canvasRef.current) {\n      ctx.current = canvasRef.current.getContext('2d');\n    }\n  }, []);\n\n  const draw = useCallback((x, y) => {\n    if (mouseDown) {\n      ctx.current.beginPath();\n      ctx.current.strokeStyle = selectedColor;\n      ctx.current.lineWidth = 10;\n      ctx.current.lineJoin = 'round';\n      ctx.current.moveTo(lastPosition.x, lastPosition.y);\n      ctx.current.lineTo(x, y);\n      ctx.current.closePath();\n      ctx.current.stroke();\n\n      console.log(x, y)\n      socket.emit('drawing', {\n        color: selectedColor,\n        x1: lastPosition.x,\n        y1: lastPosition.y,\n        x: x,\n        y: y\n      })\n      socket.on('drawing', (drew) => {\n        ctx.current.beginPath();\n        ctx.current.strokeStyle = drew.color;\n        ctx.current.lineWidth = 10;\n        ctx.current.lineJoin = 'round';\n        ctx.current.moveTo(drew.x1, drew.y1);\n        ctx.current.lineTo(drew.x, drew.y);\n        ctx.current.closePath();\n        ctx.current.stroke();\n        console.log(drew)\n      })\n\n      setPosition({\n        x,\n        y\n      })\n    }\n  }, [lastPosition, mouseDown, selectedColor, setPosition])\n\n\n\n  const download = async () => {\n    const image = canvasRef.current.toDataURL('image/png');\n    const blob = await (await fetch(image)).blob();\n    const blobURL = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = blobURL;\n    link.download = \"image.png\";\n    link.click();\n  }\n\n  const clear = () => {\n    ctx.current.clearRect(0, 0, ctx.current.canvas.width, ctx.current.canvas.height)\n  }\n\n  const onMouseDown = (e) => {\n    setPosition({\n      x: e.pageX - 305,\n      y: e.pageY - 225\n    })\n    setMouseDown(true)\n  }\n\n  const onMouseUp = (e) => {\n    setMouseDown(false)\n  }\n\n  const onMouseMove = (e) => {\n    draw(e.pageX - 305, e.pageY - 225)\n  }\n  console.log(lastPosition, setPosition)\n  return (\n    <>\n      <div className=\"Addo\">\n        <center>\n          <canvas\n            style={{\n              border: \"8px solid #000\", display: 'inline-block', background: 'white'\n            }}\n            width={900}\n            height={650}\n            ref={canvasRef}\n            onMouseDown={onMouseDown}\n            onMouseUp={onMouseUp}\n            onMouseLeave={onMouseUp}\n            onMouseMove={onMouseMove}\n          />\n        </center>\n        <br />\n        <center>\n          <select style={{ fontSize: '2rem', fontFamily: 'cursive' }}\n            value={selectedColor}\n            onChange={(e) => setSelectedColor(e.target.value)}\n          >\n            {\n              colors.map(\n                color => <option key={color} value={color}>{color}</option>\n              )\n            }\n          </select>\n          <button style={{ fontSize: '2rem', fontFamily: 'cursive' }} onClick={clear}>Clear</button>\n          <button style={{ fontSize: '2rem', fontFamily: 'cursive' }} onClick={download}>Download</button>\n        </center>\n      </div>\n    </>\n  );\n}\n\nexport default Can;"]},"metadata":{},"sourceType":"module"}